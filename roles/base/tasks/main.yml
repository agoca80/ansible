---
# roles/base/tasks/main.yml

- name: base sysctl
  with_dict: "{{ base_sysctls }}"
  sysctl:
    name: "{{ item.key }}"
    value: "{{ item.value }}"
    sysctl_set: yes

- name: base packages
  package:
    name: "{{ base_packages }}"

- name: base local directories exist
  file:
    name: /usr/local/{{ item }}
    state: directory
  loop:
    - bin
    - etc

- name: base hosts entries
  loop:
    - "127.0.0.1 {{ ansible_hostname }}"
  lineinfile:
    line: "{{ item }}"
    path: /etc/hosts

- name: base network
  loop: "{{ base_network | dict2items }}"
  lineinfile:
    backup: yes
    regexp: "^{{ item.key }}="
    path:   "/etc/rc.conf"
    line:   '{{ item.key }}="{{ item.value }}"'
  notify: restart network
